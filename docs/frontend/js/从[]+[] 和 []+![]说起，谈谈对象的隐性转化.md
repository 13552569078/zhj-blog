## 背景
最近刷文章一直刷到`[]+[]` 和 `[]+![]`的面试题，刷某音也刷到了，借助某音老师讲的，留个笔记，记录下对象的隐形转化逻辑，先公布答案 `[]+[]=""` `[]+![]="false"`

## 对象的隐性转化逻辑
对象的隐性转化逻辑分为三部，按照先后循序依次执行
### 1：`[Symbol.toPrimitive]`
首先转化逻辑，先查看是否有 `[Symbol.toPrimitive]`属性，且这个属性须是一个函数，有此属性的对象，隐性转化先执行此函数，如果此函数返回的不是基础类型，则直接报错`TypeError: Cannot convert object to primitive value `
#### `[Symbol.toPrimitive]`返回基础类型，`obj+'end'`触发隐性转化

```js
const obj = {
  [Symbol.toPrimitive]:()=>{
    return "toPrimitive"
  }
}
// obj转化为 "toPrimitive" +"end"
console.log(obj+'end') // toPrimitiveend
```

#### `[Symbol.toPrimitive]`返回未基础类型，则直接报错


```js
const obj = {
  [Symbol.toPrimitive]:()=>{
    return []
  }
}
console.log(obj+'end')
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da696ed75a9a47b5b86f58e6f8ff6b0c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=489&h=114&s=3742&e=png&b=fef7f7)

### 2：`valueOf`
无`[Symbol.toPrimitive]`属性，则会走`valueOf`属性转化逻辑，`valueOf`可以返回基础类型也可不返回基础类型
#### `valueOf`返回基础类型

```js
const obj = {
  // [Symbol.toPrimitive]:()=>{
  //   return []
  // }
  valueOf:()=>{
    return "valueOf"
  }
}
// obj转化为 "valueOf" +"end"
console.log(obj+'end') // valueOfend

```

#### `valueOf`不返回基础类型，则会走第三步` toString `

### 3：`toString`

前方2个属性都没有，或者`valueOf`返回的不是基础类型，则会走`toString`来转义


```js
const obj = {
  // [Symbol.toPrimitive]:()=>{
  //   return []
  // }
  // valueOf:()=>{
  //   return []
  // }
  toString:()=>{
    return 'toString'
  }
}
console.log(obj+'end') // toStringend
```

如果`toString`返回的也不是基础类型，则会报错


```js
const obj = {
  // [Symbol.toPrimitive]:()=>{
  //   return []
  // }
  // valueOf:()=>{
  //   return []
  // }
  toString:()=>{
    return []
  }
}
console.log(obj+'end')
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f36bf40cb2964c12b29dcb99f7dad97a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=492&h=122&s=4392&e=png&b=fef8f8)

## 面试题答案解析
#### `[]+[]`解析
基于以上的对象隐性转化逻辑，我们先分析 第一道题 `[]+[]`为何等于`""`空字符串
我们先看`[]+[]`,会触发对象的隐性转义，我们按照上诉三个步骤，依次看下空数组`[]`隐性转化成什么 

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ad46df8e87f40f8abf3da69fde7fdd8~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=411&h=190&s=4487&e=png&b=ffffff)

控制台打印可见：`[]`不存在`[Symbol.toPrimitive]`属性， `valueOf()`返回的是`[]`不是基础类型，所以走第三步 `toString()`返回空字符串，综上 `[]+[]`等于`""`空字符串

#### `[]+![]`解析
通过第一题我们我们可知 左侧空数组`[]`转义成空字符串 `""`, 右侧 `![]`如何转化是布尔运算，布尔运算完成后再进行隐性转化 `[]`的布尔运算为 `true`

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b61ec403a2b44dd8b991a6189b1d6472~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=321&h=199&s=4071&e=png&b=ffffff)

此时 `![]`进行取反操作为 `false` 此时上述题目转译成 `""+false`结果为字符串` "false"`

## 总结
1：对象的隐性转化顺序，1：`[Symbol.toPrimitive]` 2：`valueOf` 3：`toString`

2：隐性转化优先级低于布尔转化 可查看运算符优先级[运算符](https://blog.csdn.net/weixin_42373175/article/details/132742334)
